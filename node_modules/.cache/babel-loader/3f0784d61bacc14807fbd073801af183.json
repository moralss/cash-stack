{"ast":null,"code":"import axios from \"axios\";\nimport history from \"../routes/history\";\nimport * as actions from '../actionTypes/index';\nimport jwtDecode from \"jwt-decode\";\nconst URL = \"http://localhost:3001\";\nexport const registerUser = credentials => {\n  return async dispatch => {\n    try {\n      const res = await axios.post(\"\".concat(URL, \"/signin\"), credentials);\n      const decodedToken = jwtDecode(res.data.token);\n      dispatch({\n        type: actions.SET_USER,\n        payload: {\n          profile: {\n            id: decodedToken.sub,\n            name: decodedToken.name,\n            email: decodedToken.email,\n            refNumber: decodedToken.refNumber\n          }\n        }\n      });\n      localStorage.setItem(\"user\", res.data.token);\n      dispatch({\n        type: actions.AUTHENTICATED,\n        payload: {\n          auth: true\n        }\n      });\n      history.push(\"/dashboard\");\n    } catch (error) {\n      console.log(error);\n    }\n  };\n};\nexport const login = credentials => {\n  return async dispatch => {\n    try {\n      const res = await axios.post(\"\".concat(URL, \"/login\"), credentials);\n      const decodedToken = jwtDecode(res.data.token);\n      console.log(\"decodeToken\", decodedToken);\n      dispatch({\n        type: actions.SET_USER,\n        payload: {\n          profile: {\n            id: decodedToken.sub,\n            name: decodedToken.name,\n            email: decodedToken.email,\n            refNumber: decodedToken.refNumber\n          }\n        }\n      });\n      localStorage.setItem(\"user\", res.data.token);\n      dispatch({\n        type: actions.AUTHENTICATED,\n        payload: {\n          auth: true\n        }\n      });\n      history.push(\"/dashboard\");\n      return;\n    } catch (e) {\n      const data = !e.response ? null : e.response.data.error;\n      dispatch({\n        type: actions.AUTH_ERROR,\n        payload: {\n          error: data\n        }\n      });\n      return;\n    }\n  };\n};","map":{"version":3,"sources":["/home/moral/workspace/start/src/actions/auth.js"],"names":["axios","history","actions","jwtDecode","URL","registerUser","credentials","dispatch","res","post","decodedToken","data","token","type","SET_USER","payload","profile","id","sub","name","email","refNumber","localStorage","setItem","AUTHENTICATED","auth","push","error","console","log","login","e","response","AUTH_ERROR"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,OAAP,MAAoB,mBAApB;AACA,OAAO,KAAKC,OAAZ,MAAyB,sBAAzB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,MAAMC,GAAG,GAAG,uBAAZ;AAGA,OAAO,MAAMC,YAAY,GAAIC,WAAD,IAAiB;AAC3C,SAAO,MAAMC,QAAN,IAAkB;AACvB,QAAI;AACF,YAAMC,GAAG,GAAG,MAAMR,KAAK,CAACS,IAAN,WAAcL,GAAd,cAA4BE,WAA5B,CAAlB;AACA,YAAMI,YAAY,GAAGP,SAAS,CAACK,GAAG,CAACG,IAAJ,CAASC,KAAV,CAA9B;AACAL,MAAAA,QAAQ,CAAC;AACPM,QAAAA,IAAI,EAAEX,OAAO,CAACY,QADP;AAEPC,QAAAA,OAAO,EAAE;AACPC,UAAAA,OAAO,EAAE;AACPC,YAAAA,EAAE,EAAEP,YAAY,CAACQ,GADV;AAEPC,YAAAA,IAAI,EAAET,YAAY,CAACS,IAFZ;AAGPC,YAAAA,KAAK,EAAEV,YAAY,CAACU,KAHb;AAIPC,YAAAA,SAAS,EAAEX,YAAY,CAACW;AAJjB;AADF;AAFF,OAAD,CAAR;AAWAC,MAAAA,YAAY,CAACC,OAAb,CAAqB,MAArB,EAA6Bf,GAAG,CAACG,IAAJ,CAASC,KAAtC;AACAL,MAAAA,QAAQ,CAAC;AACPM,QAAAA,IAAI,EAAEX,OAAO,CAACsB,aADP;AAEPT,QAAAA,OAAO,EAAE;AACPU,UAAAA,IAAI,EAAE;AADC;AAFF,OAAD,CAAR;AAMAxB,MAAAA,OAAO,CAACyB,IAAR,CAAa,YAAb;AACD,KAtBD,CAsBE,OAAOC,KAAP,EAAc;AACdC,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACD;AACF,GA1BD;AA2BD,CA5BM;AA+BP,OAAO,MAAMG,KAAK,GAAIxB,WAAD,IAAiB;AACpC,SAAO,MAAMC,QAAN,IAAkB;AACvB,QAAI;AACF,YAAMC,GAAG,GAAG,MAAMR,KAAK,CAACS,IAAN,WAAcL,GAAd,aAA2BE,WAA3B,CAAlB;AACA,YAAMI,YAAY,GAAGP,SAAS,CAACK,GAAG,CAACG,IAAJ,CAASC,KAAV,CAA9B;AACAgB,MAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BnB,YAA3B;AACAH,MAAAA,QAAQ,CAAC;AACPM,QAAAA,IAAI,EAAEX,OAAO,CAACY,QADP;AAEPC,QAAAA,OAAO,EAAE;AACPC,UAAAA,OAAO,EAAE;AACPC,YAAAA,EAAE,EAAEP,YAAY,CAACQ,GADV;AAEPC,YAAAA,IAAI,EAAET,YAAY,CAACS,IAFZ;AAGPC,YAAAA,KAAK,EAAEV,YAAY,CAACU,KAHb;AAIPC,YAAAA,SAAS,EAAEX,YAAY,CAACW;AAJjB;AADF;AAFF,OAAD,CAAR;AAWAC,MAAAA,YAAY,CAACC,OAAb,CAAqB,MAArB,EAA6Bf,GAAG,CAACG,IAAJ,CAASC,KAAtC;AACAL,MAAAA,QAAQ,CAAC;AACPM,QAAAA,IAAI,EAAEX,OAAO,CAACsB,aADP;AAEPT,QAAAA,OAAO,EAAE;AACPU,UAAAA,IAAI,EAAE;AADC;AAFF,OAAD,CAAR;AAMAxB,MAAAA,OAAO,CAACyB,IAAR,CAAa,YAAb;AACA;AACD,KAxBD,CAwBE,OAAOK,CAAP,EAAU;AACV,YAAMpB,IAAI,GAAG,CAACoB,CAAC,CAACC,QAAH,GAAc,IAAd,GAAqBD,CAAC,CAACC,QAAF,CAAWrB,IAAX,CAAgBgB,KAAlD;AACApB,MAAAA,QAAQ,CAAC;AACPM,QAAAA,IAAI,EAAEX,OAAO,CAAC+B,UADP;AAEPlB,QAAAA,OAAO,EAAE;AACPY,UAAAA,KAAK,EAAEhB;AADA;AAFF,OAAD,CAAR;AAMA;AACD;AACF,GAnCD;AAoCD,CArCM","sourcesContent":["import axios from \"axios\";\nimport history from \"../routes/history\";\nimport * as actions from '../actionTypes/index'\nimport jwtDecode from \"jwt-decode\";\nconst URL = \"http://localhost:3001\";\n\n\nexport const registerUser = (credentials) => {\n  return async dispatch => {\n    try {\n      const res = await axios.post(`${URL}/signin`, credentials);\n      const decodedToken = jwtDecode(res.data.token);\n      dispatch({\n        type: actions.SET_USER,\n        payload: {\n          profile: {\n            id: decodedToken.sub,\n            name: decodedToken.name,\n            email: decodedToken.email,\n            refNumber: decodedToken.refNumber\n          }\n        }\n      });\n      localStorage.setItem(\"user\", res.data.token);\n      dispatch({\n        type: actions.AUTHENTICATED,\n        payload: {\n          auth: true\n        }\n      });\n      history.push(\"/dashboard\")\n    } catch (error) {\n      console.log(error);\n    }\n  };\n};\n\n\nexport const login = (credentials) => {\n  return async dispatch => {\n    try {\n      const res = await axios.post(`${URL}/login`, credentials);\n      const decodedToken = jwtDecode(res.data.token);\n      console.log(\"decodeToken\", decodedToken)\n      dispatch({\n        type: actions.SET_USER,\n        payload: {\n          profile: {\n            id: decodedToken.sub,\n            name: decodedToken.name,\n            email: decodedToken.email,\n            refNumber: decodedToken.refNumber\n          }\n        }\n      });\n      localStorage.setItem(\"user\", res.data.token);\n      dispatch({\n        type: actions.AUTHENTICATED,\n        payload: {\n          auth: true\n        }\n      });\n      history.push(\"/dashboard\")\n      return\n    } catch (e) {\n      const data = !e.response ? null : e.response.data.error;\n      dispatch({\n        type: actions.AUTH_ERROR,\n        payload: {\n          error: data\n        }\n      });\n      return\n    }\n  };\n};"]},"metadata":{},"sourceType":"module"}